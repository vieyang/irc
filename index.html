<!doctype html><html><head><meta charset="utf-8"><title>万物互聊</title><link href="https://cdn.bootcss.com/bootstrap/4.0.0-alpha.3/css/bootstrap.css" rel="stylesheet"><link href="https://cdn.bootcss.com/bootstrap/4.0.0-alpha.3/css/bootstrap.min.css" rel="stylesheet"><script src="https://cdn.bootcss.com/bootstrap/4.0.0-alpha.3/js/bootstrap.js"></script><script src="https://cdn.bootcss.com/bootstrap/4.0.0-alpha.3/js/bootstrap.min.js"></script><script src="https://cdn.wilddog.com/js/client/current/wilddog.js"></script><script type="text/javascript">function getCookie(e){return document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),-1!=c_start)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""}function setCookie(e,t,c){var n=new Date;n.setDate(n.getDate()+c),document.cookie=e+"="+escape(t)+(null==c?"":"; expires="+n.toGMTString())}</script><script>var ref=new Wilddog("https://irc.wilddogio.com/msgs/"),name=getCookie("nickname");null==name&&(name="");</script></head><body><div class="container"><div class="row clearfix"><div class="col-md-5 offset-xs-5 column"><h1>IRC</h1></div></div><br><br><div class="row clearfix"><div class="col-md-6 column"><input id="utx" class="form-control" type="text" placeholder="请给自己起个好听的名字~~~"></div><div class="col-md-6 column"><input class="btn btn-info btn-block" type="button" onclick="initName()" value="设置"></div></div><br><div class="row clearfix"><div class="col-md-12 column"><textarea class="form-control" style="width:100%;height:500px" id="tx" disabled></textarea></div></div><br><div class="row clearfix"><div class="col-md-12 column"><textarea class="form-control" style="width:100%;height:100px" id="wtx"></textarea></div></div><div class="row clearfix"><div class="col-md-2 column"><input type="button" class="btn btn-success btn-lg btn-block" onclick="onUpdate()" value="发送"></div><div class="col-md-6 column"></div><div class="col-md-4 column"></div></div></div><script>function onValue(){tx.innerHTML="",ref.once("value",function(e){console.log("onValue");var n=e.val();console.log(n);for(var t in n)tx.innerHTML+=n[t].userid+":"+n[t].msg+"\r\n"})}function onUpdate(){if(""==name)return void alert("给自己起个昵称~~~");var e=wtx.value;return""==e?(wtx.value="",alert("输入点内容~~~"),void(wtx.value="")):(ref.push({date:"123",msg:e,userid:name}),void(wtx.value=""))}function initName(){if(name!=ntx.value){if(""==ntx.value)return void alert("不能使用空格昵称~~~");var e="";e=""==name?"欢迎新用户["+ntx.value+"]":"我把昵称改成了["+ntx.value+"]",ref.push({date:"123",msg:e,userid:name}),name=ntx.value,setCookie("nickname",name,365)}}var tx=document.getElementById("tx"),wtx=document.getElementById("wtx"),ntx=document.getElementById("utx");ref.on("child_added",function(e){var n=e.val();tx.innerHTML+=""==n.userid?"*** "+n.msg+" ***\r\n":n.userid+": "+n.msg+"\r\n",tx.scrollTop=tx.scrollHeight}),ntx.value=name,document.onkeydown=function(e){13==e.keyCode&&e.ctrlKey?wtx.value+="\r\n":13==e.keyCode&&(e.preventDefault(),onUpdate())};</script></body></html>
